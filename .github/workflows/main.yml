name: GitHub Classroom Workflow

on:
  - push
  - workflow_dispatch

permissions:
  checks: write
  actions: read
  contents: read

jobs:
  build:
    # Installe java 8 sur l'agent
    - name: Set up JDK 8
      uses: actions/setup-java@v2
      with:
        java-version: '8'
        distribution: 'adopt'

    # Compile notre application
    - name: Build with Maven
      run: mvn --batch-mode --update-snapshots package

    # Publie les fichiers pr√©sents dans le dossier target dans un build artifact
    - name: Upload a Build Artifact
      uses: actions/upload-artifact@v2.2.4
      with:
        name: my-app-1.0
        path: target/*

          # Installe la commande docker sur l'agent
          - name: Install Docker
            uses: docker/setup-buildx-action@v1
            id: buildx
            with:
              install: true
              
          # Build l'image Docker
          - name: Docker build
            run: |
              docker build .